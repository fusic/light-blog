<!DOCTYPE HTML>
<html lang="ja">
<head>
  <meta charset="utf-8">
  
  <title>LIGHT@NOON【Laravelアンチパターン編】振り返り | LIGHT BLOG</title>
  <meta name="author" content="light">
  
  <meta name="description" content="こんにちは、Fusic チーム LIGHT の近藤です！
今回は、4/20(火) に開催されたチーム LIGHT 主催イベント LIGHT@NOON Laravelアンチパターン編 の振り返り記事となっております。
当日ご参加くださった皆さま、ありがとうございました〜！
放送はアーカイブとして残してありますので、未視聴の方はぜひご覧ください！https://youtu.be/qww8M6cktFc
目次
各章の補足とコメント返し
感想
次回予告">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="LIGHT@NOON【Laravelアンチパターン編】振り返り"/>
  <meta property="og:site_name" content="LIGHT BLOG"/>

  
    <meta property="og:image" content=""/>
  
  <meta name="description" content="こんにちは、Fusic チーム LIGHT の近藤です！ 今回は、4&#x2F;20(火) に開催されたチーム LIGHT 主催イベント LIGHT@NOON Laravelアンチパターン編 の振り返り記事となっております。 当日ご参加くださった皆さま、ありがとうございました〜！ 放送はアーカイブとして残してありますので、未視聴の方はぜひご覧ください！https:&#x2F;&#x2F;youtu.be&#x2F;qww8M6cktFc">
<meta property="og:type" content="article">
<meta property="og:title" content="LIGHT@NOON【Laravelアンチパターン編】振り返り">
<meta property="og:url" content="https://light.fusic.co.jp/2021/05/11/20210425-kondo/index.html">
<meta property="og:site_name" content="LIGHT BLOG">
<meta property="og:description" content="こんにちは、Fusic チーム LIGHT の近藤です！ 今回は、4&#x2F;20(火) に開催されたチーム LIGHT 主催イベント LIGHT@NOON Laravelアンチパターン編 の振り返り記事となっております。 当日ご参加くださった皆さま、ありがとうございました〜！ 放送はアーカイブとして残してありますので、未視聴の方はぜひご覧ください！https:&#x2F;&#x2F;youtu.be&#x2F;qww8M6cktFc">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://light.fusic.co.jp/images/logo/logo_LIGHT_256.png">
<meta property="article:published_time" content="2021-05-11T01:36:30.000Z">
<meta property="article:modified_time" content="2021-05-21T03:22:34.506Z">
<meta property="article:author" content="light">
<meta property="article:tag" content="Laravel">
<meta property="article:tag" content="LIGHT@NOON">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://light.fusic.co.jp/images/logo/logo_LIGHT_256.png">

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="LIGHT BLOG" type="application/atom+xml">
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-173218946-1', 'auto');
	ga('send', 'pageview');

</script>


<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/"><img src="/favicon.png" height="30" style="margin:0 5px 2px 0; vertical-align: bottom;">LIGHT BLOG</a></h1>
  <h2><a href="/" style="margin: 55px;">チームLIGHTの雑記ブログ</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/members">Members</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article id="post-20210425-kondo" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-05-11T01:36:30.000Z"><a href="/2021/05/11/20210425-kondo/">2021/05/11</a></time>
      
      
  
    <h1 class="p-name title" itemprop="headline name">LIGHT@NOON【Laravelアンチパターン編】振り返り</h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>こんにちは、Fusic チーム LIGHT の近藤です！</p>
<p>今回は、4/20(火) に開催されたチーム LIGHT 主催イベント <a href="https://fusic.connpass.com/event/209434/" target="_blank" rel="noopener">LIGHT@NOON Laravelアンチパターン編</a> の振り返り記事となっております。</p>
<p>当日ご参加くださった皆さま、ありがとうございました〜！</p>
<p>放送はアーカイブとして残してありますので、未視聴の方はぜひご覧ください！<br><a href="https://youtu.be/qww8M6cktFc" target="_blank" rel="noopener">https://youtu.be/qww8M6cktFc</a></p>
<h2><span id="目次">目次</span></h2><ol>
<li>各章の補足とコメント返し</li>
<li>感想</li>
<li>次回予告</li>
</ol>
<a id="more"></a>

<h2><span id="1-各章の補足とコメント返し">1. 各章の補足とコメント返し</span></h2><h3><span id="orm">ORM</span></h3><p>櫻川さんが紹介していた N+1 を検知するプラグイン<br><a href="https://github.com/beyondcode/laravel-query-detector" target="_blank" rel="noopener">https://github.com/beyondcode/laravel-query-detector</a></p>
<p>with プロパティ<br><a href="https://github.com/laravel/framework/blob/5a65f25ba37d7b60e056ce9f2268d401925b6548/src/Illuminate/Database/Eloquent/Model.php#L75" target="_blank" rel="noopener">https://github.com/laravel/framework/blob/5a65f25ba37d7b60e056ce9f2268d401925b6548/src/Illuminate/Database/Eloquent/Model.php#L75</a></p>
<p>with メソッドを無効にする without メソッド(恐らくこれだと思われます)<br><a href="https://github.com/laravel/framework/blob/314bf875ba5d37c056ccea5148181fcb0517f596/src/Illuminate/Database/Eloquent/Model.php#L290" target="_blank" rel="noopener">https://github.com/laravel/framework/blob/314bf875ba5d37c056ccea5148181fcb0517f596/src/Illuminate/Database/Eloquent/Model.php#L290</a></p>
<p><strong>コメント</strong></p>
<blockquote>
<p>突き詰めていくと、フレームワークなんでも良くなる</p>
</blockquote>
<p>これには完全同意です。<br>ただ、「好き勝手しやすさ」はやっぱりフレームワークによって違いますよね。<br>もともと規約で縛る思想の CakePHP より、 Laravel のほうが柔軟に、いろいろな設計思想に対応させやすい。<br>これは Laravel がここまで広まった理由の1つかもしれません。</p>
<blockquote>
<p>Laravelで無駄に便利だなと思ったのはSoftDelete対応。</p>
</blockquote>
<p>FuelPHP =&gt; Laravel の順で触った人間としては、これを知ったときはなかなか衝撃的でした。<br>私個人は論理削除反対派なので、SoftDelete のお世話にはならないのですが……。</p>
<p>こういった <strong>一定数需要があるものは手軽に実装できる</strong> のが Laravel というフレームワークの強みですよね。<br>ただし、プロジェクトの規模やメンバーの習熟度によっては、その手軽さは諸刃の刃になり得ます。<br>LIVE 中話題になった N+1 問題も、「手軽さ」によって生まれる悲劇の1つではないでしょうか。</p>
<h3><span id="facade">Facade</span></h3><p>Facade を使わない開発についてコメント欄で紹介されていたスライド<br><a href="https://www.slideshare.net/KenjiroKubota/laravelfacade" target="_blank" rel="noopener">https://www.slideshare.net/KenjiroKubota/laravelfacade</a></p>
<p><strong>コメント</strong></p>
<blockquote>
<p>いまだにFacadeにするのか、ただのStaticなクラスを作るのかの違いがしっくりしてない</p>
</blockquote>
<p>これについては、そもそも static メソッドの呼び出しが必要なシーンがどれだけあるか、という点が疑問です。<br>「コード中で明示的にインスタンス化せずとも呼べて便利だよね」以上の意味があるならば、<br>static クラスである必然性があり、迷うことはないと思います。例えば、クラス変数を利用したい場合など。</p>
<p>必然性による判断ができない場合は、テスト容易性の観点から考えると良いかもしれません。</p>
<p>LIVE 中でも語りましたが、 Facade は shouldReceive メソッドを持っているため、モック化が非常に簡単です。<br><a href="https://github.com/mockery/mockery" target="_blank" rel="noopener">Mockery</a> の提供する基本的な機能のほとんどを利用できます。</p>
<p>一方、 static メソッドの場合は違います。<br>static メソッドのモックについて、Mockery は<a href="http://docs.mockery.io/en/latest/reference/creating_test_doubles.html#creating-test-doubles-aliasing" target="_blank" rel="noopener">エイリアスの機能</a>を提供しています。<br>しかし、</p>
<blockquote>
<p>Even though aliasing classes is supported, we do not recommend it.</p>
</blockquote>
<p>とあるように、 Mockery は <strong>お勧めしていません</strong>。<br>そもそも static クラスをモックしたいと思った時点で、クラス設計に誤りのある可能性が高いです。<br>その場合には、 Facade で代替可能である、と考えたほうが良いでしょう。</p>
<p>Laravel についてもう少し踏み込んだ理解のある方は「本当に Facade である必要があるか」も一考すべきでしょう。<br>Laravel の特徴の 1 つに、 DI(依存性注入) が容易であることがあります。<br>DI を利用することで、モック化したインスタンスを利用したテストが可能です。</p>
<h3><span id="task-scheduling">Task Scheduling</span></h3><p>Task Scheduleing の GUI ツールとして紹介のあった Laravel-totem<br><a href="https://github.com/codestudiohq/laravel-totem" target="_blank" rel="noopener">https://github.com/codestudiohq/laravel-totem</a></p>
<p><strong>コメント</strong></p>
<blockquote>
<p>N分毎に実行したい、はアプリケーションなので、関心の分離的にもコードに落としたいですね</p>
</blockquote>
<p>確かに定期実行処理は、いわゆるビジネスロジックな場合が多いですね。<br>Task Scheduling は単一障害点になる、という意見もありますが、<br>アプリケーションコード全体の設計を見たときには、利用するほうが良いように思います。</p>
<h2><span id="2-感想">2. 感想</span></h2><p>初めてのオンラインイベント、非常に緊張していましたが終始楽しくお話することができました。<br>あれから 3 週間も経っていることが信じられません（記事を書くのが遅くてすみません）。</p>
<p>司会と配信準備のすべてを担った吉野先生、<br>LIGHT@NOON のアイキャッチやロゴを考えてくれた礒谷さん、<br>当日社内 Slack でがやがや励ましてくれた坂井さん・岸田さん、<br>出演頂いた櫻川大先生、<br>そしてご視聴くださった皆様、ここまで読んでくださった皆様、ありがとうございました！</p>
<p>この振り返り記事が、誰かの学びのヒントになれば幸いです。</p>
<h2><span id="3-次回予告">3. 次回予告</span></h2><p>さて、次回の LIGHT@NOON は 2021/05/25 12:00〜</p>
<p>「初めての社内デザイナー編」！</p>
<p>我がチーム LIGHT の誇る、Fusic 唯一の Web デザイナー・礒谷悠莉さんが登壇します！</p>
<p>エンジニア組織に 1 人飛び込んできた磯谷さんが、<br>入社から 4 ヵ月経った今、これまでの振り返りやこれからについて語ります。</p>
<p>connpass ページはこちらから！</p>
<p>皆様のご参加をお待ちしております〜<br><a href="https://fusic.connpass.com/event/211143/" target="_blank" rel="noopener">https://fusic.connpass.com/event/211143/</a></p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/Kondo/">Kondo</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/Laravel/">Laravel</a>, <a href="/tags/LIGHT-NOON/">LIGHT@NOON</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet" style="padding-right:15px;"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">コメント</h1>

  
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
  </div>
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="検索">
    <input type="hidden" name="as_sitesearch" value="light.fusic.co.jp">
  </form>
</div>


  
<div class="widget tag">
  <h3 class="title">カテゴリー</h3>
  <ul class="entry">
  
    <li><a href="/categories/Isogai/">Isogai</a><small>3</small></li>
  
    <li><a href="/categories/Kishida/">Kishida</a><small>3</small></li>
  
    <li><a href="/categories/Kondo/">Kondo</a><small>3</small></li>
  
    <li><a href="/categories/Sakai/">Sakai</a><small>3</small></li>
  
    <li><a href="/categories/Sasahira/">Sasahira</a><small>5</small></li>
  
    <li><a href="/categories/Yoshino/">Yoshino</a><small>4</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">タグ</h3>
  <ul class="entry">
  
    <li><a href="/tags/DTM/">DTM</a><small>1</small></li>
  
    <li><a href="/tags/Golang/">Golang</a><small>1</small></li>
  
    <li><a href="/tags/LIGHT-NOON/">LIGHT@NOON</a><small>2</small></li>
  
    <li><a href="/tags/Laravel/">Laravel</a><small>1</small></li>
  
    <li><a href="/tags/LeetCode/">LeetCode</a><small>1</small></li>
  
    <li><a href="/tags/いきものがかり/">いきものがかり</a><small>1</small></li>
  
    <li><a href="/tags/イベントレポート/">イベントレポート</a><small>2</small></li>
  
    <li><a href="/tags/シェアハウス/">シェアハウス</a><small>1</small></li>
  
    <li><a href="/tags/デザイナー/">デザイナー</a><small>1</small></li>
  
    <li><a href="/tags/ポエム/">ポエム</a><small>1</small></li>
  
    <li><a href="/tags/ライブ/">ライブ</a><small>1</small></li>
  
    <li><a href="/tags/技術/">技術</a><small>1</small></li>
  
    <li><a href="/tags/業務ハック/">業務ハック</a><small>1</small></li>
  
    <li><a href="/tags/社内文化/">社内文化</a><small>5</small></li>
  
    <li><a href="/tags/福岡市博物館/">福岡市博物館</a><small>1</small></li>
  
    <li><a href="/tags/雑記/">雑記</a><small>15</small></li>
  
    <li><a href="/tags/音楽/">音楽</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2021 light
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>



<script type="text/javascript">
var disqus_shortname = 'lightblog-1';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script src="/fancybox/jquery.fancybox.pack.js"></script>

<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
